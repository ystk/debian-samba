--- a/source4/dns_server/dns_query.c
+++ b/source4/dns_server/dns_query.c
@@ -39,6 +39,7 @@
 
 #undef DBGC_CLASS
 #define DBGC_CLASS DBGC_DNS
+#define MAX_Q_RECURSION_DEPTH 20
 
 static WERROR create_response_rr(const struct dns_name_question *question,
 				 const struct dnsp_DnssrvRpcRecord *rec,
@@ -261,6 +262,10 @@
 	uint16_t rec_count, ai = *ancount;
 	struct ldb_dn *dn = NULL;
 
+	if (talloc_array_length(*answers) >= MAX_Q_RECURSION_DEPTH) {
+		return WERR_OK;
+	}
+
 	werror = dns_name2dn(dns, mem_ctx, question->name, &dn);
 	W_ERROR_NOT_OK_RETURN(werror);
 
