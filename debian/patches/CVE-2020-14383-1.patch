From 32ca608ac27f3500920f1479c44f7efc7042416d Mon Sep 17 00:00:00 2001
From: Noel Power <noel.power@suse.com>
Date: Wed, 22 May 2019 09:47:27 +0000
Subject: [PATCH 1/3] s4/rpc_server/dnsserver: clang: fix Value stored to
 'status' is never read

Fix the following warnings

source4/rpc_server/dnsserver/dcerpc_dnsserver.c:1021: error: uninitvar: Uninitialized variable: answer_integer <--[cppcheck]
source4/rpc_server/dnsserver/dcerpc_dnsserver.c:1723:4: warning: Value stored to 'status' is never read <--[clang]
                        status = dns_fill_records_array(tmp_ctx, NULL, DNS_TYPE_A,
                        ^        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
source4/rpc_server/dnsserver/dcerpc_dnsserver.c:1881:4: warning: Value stored to 'status' is never read <--[clang]
                        status = dns_fill_records_array(tmp_ctx, NULL, DNS_TYPE_A,

Signed-off-by: Noel Power <noel.power@suse.com>
Reviewed-by: Andreas Schneider <asn@samba.org>
(cherry picked from commit bcc6b8c2492b87fb4ac6bdb5075a5831d71bade8)
---
 source4/rpc_server/dnsserver/dcerpc_dnsserver.c | 8 ++++++++
 1 file changed, 8 insertions(+)

--- a/source4/rpc_server/dnsserver/dcerpc_dnsserver.c
+++ b/source4/rpc_server/dnsserver/dcerpc_dnsserver.c
@@ -1696,6 +1696,10 @@ static WERROR dnsserver_enumerate_root_r
 							NULL, NULL);
 			talloc_free(rname);
 			talloc_free(res);
+			if (!W_ERROR_IS_OK(status)) {
+				talloc_free(tmp_ctx);
+				return status;
+			}
 		}
 	}
 
@@ -1853,6 +1857,10 @@ static WERROR dnsserver_enumerate_record
 							NULL, NULL);
 			talloc_free(rname);
 			talloc_free(res);
+			if (!W_ERROR_IS_OK(status)) {
+				talloc_free(tmp_ctx);
+				return status;
+			}
 		}
 	}
 
